# Virtual Rainforest example data

Example data is included with Virtual Rainforest to provide an introduction to the file
formats and configuration. Using this data is described in the [usage](./usage.md)
documentation and this page describes the structure and contents of the example data
folder.

It might be useful to install the `vr_example` directory to a location of your choice
when reading these notes, using the command shown below, but the contents of the key
files are also linked on this page.

```shell
vr_run --install-example /location/path/
```

## Example data directory structure

The `vr_example` directory contains the following sub-directories:

1. The `config` directory contains three configuration files that combine to provide a
   basic complete configuration for the example data.

1. The `data` directory contains NetCDF format files containing the variables required
   to initialise the model and then iterate over a time series.

1. The empty `out` directory is simply used as a location to store model outputs.

1. The `generation_scripts` directory contains Python scripts that are used to generate
   the contents of the `data` directory. You won't typically need to look at these, but
   they provide simple recipes for creating or editing the input data files.

1. A `source` directory that contains files used to create the input data files.

## Configuration files

The example configuration files are:

* The **`vr_run.toml`** configures the models to be used in the simulation and the order
  in which they are initialised and updated.

````{admonition} config/vr_run.toml
:class: dropdown
```{literalinclude} ../../../virtual_rainforest/example_data/config/vr_run.toml
```
````

* The **`data_config.toml`** file configures the initial variables to be loaded and sets
  the paths to the source files providing those variables.

````{admonition} config/data_config.toml
:class: dropdown
```{literalinclude} ../../../virtual_rainforest/example_data/config/data_config.toml
```
````

* The **`animal_functional_groups.toml`** file provides basic configuration for the
  `animals` model to set functional group definitions.

````{admonition} config/animal_functional_groups.toml
:class: dropdown
```{literalinclude} ../../../virtual_rainforest/example_data/config/animal_functional_groups.toml
```
````

* The **`plant_config.toml`** file provides basic configuration for the
  `plants` model to set functional group definitions.

````{admonition} config/plant_config.toml
:class: dropdown
```{literalinclude} ../../../virtual_rainforest/example_data/config/plant_config.toml
```
````

## Example data files

The [data configuration
file](../../../virtual_rainforest/example_data/config/data_config.toml) sets up the
links between the variables used in the models and the provided data file in which they
are stored. The NetCDF files in the `data` directory are all generated by the Python
scripts provided in the `generation_scripts` directory, which provide some simple
recipes for creating various kinds of input data and saving them in the required format.

```{warning}
All of these data files currently contain artificial data to test the program flow and
data handling of the Virtual Rainforest simulation. Although some values are taken from
real source data, this is **not yet a meaningful real world example dataset**.
```

The **`common.py`** script file defines some common elements that are used across the
data generation scripts, primarily the spatial grid to be used and the dates for time
series data.

````{admonition} common.py
:class: dropdown
```{literalinclude} ../../../virtual_rainforest/example_data/generation_scripts/common.py
```
````

### Elevation data

The `data/example_elevation_data.nc` file provides:

```{list-table}
* - Variable
  - Name
  - Unit
  - Dims
* - elevation
  - `elevation`
  - m
  - XY
```

````{admonition} elevation_example_data.py
:class: dropdown
```{literalinclude} ../../../virtual_rainforest/example_data/generation_scripts/elevation_example_data.py
```
````

This code creates a dummy elevation map from a digital elevation model
([SRTM](https://www2.jpl.nasa.gov/srtm/)) which is required to run, amongst others, the
{mod}`~virtual_rainforest.models.hydrology.hydrology_model`. The initial data covers the
region 4°N 116°E to 5°N 117°E, see [SAFE
wiki](https://safeproject.net/dokuwiki/safe_gis/srtm) for reference and download. We
reduce the initial 30m spatial resolution to match the 9 x 9 grid of the example
simulation while covering an area similar to the climate dummy data.

### Climate data

The `example_climate_data.nc` file provides:

```{list-table}
* - Variable
  - Name
  - Unit
  - Dims
* - air temperature
  - `air_temperature_ref`
  - °C
  - XYT
* - relative humidity
  - `relative_humidity_ref`
  - unitless
  - XYT
* - atmospheric pressure
  - `atmospheric_pressure_ref`
  - kPa
  - XYT
* - precipitation
  - `precipitation`
  - mm $\textrm{month}^{-1}$
  - XYT
* - atmospheric $\ce{CO_{2}}$ concentration
  - `atmospheric_co2_ref`
  - ppm
  - XYT
* - mean annual temperature
  - `mean_annual_temperature`
  - °C
  - XY
```

````{admonition} climate_example_data.py
:class: dropdown
```{literalinclude} ../../../virtual_rainforest/example_data/generation_scripts/climate_example_data.py
```
````

The dummy climate data for the example simulation is based on monthly ERA5-Land data
which can be downloaded from the [Copernicus climate data store](https://cds.climate.copernicus.eu/cdsapp#!/dataset/reanalysis-era5-single-levels-monthly-means?tab=overview).
See the [climate data recipes page](../data_recipes/climate_data_recipes.md) for more
details.

### Hydrology data

The `example_surface_runoff_data.nc` file provides:

```{list-table}
* - Variable
  - Name
  - Unit
  - Dims
* - surface runoff
  - `surface_runoff`
  - mm
  - XY
```

````{admonition} runoff_example_data.py
:class: dropdown
```{literalinclude} ../../../virtual_rainforest/example_data/generation_scripts/runoff_example_data.py
```
````

The hydrology model requires an initial surface runoff field to calculate accumulated
surface runoff. This value is currently created using a normal distribution, and
adjusted to Virtual Rainforest conventions, but will in the future be estimated from
rainfall data using the SPLASH model.

### Soil data

The `example_soil_data.nc` file provides:

```{list-table}
* - Variable
  - Name
  - Unit
  - Dims
* - pH
  - `pH` 
  - unitless
  - XY
* - Bulk soil density
  - `bulk_density` 
  - kg $\textrm{m}^{-3}$
  - XY
* - Soil clay fraction
  - `clay_fraction` 
  - unitless
  - XY
* - Soil low molecular weight carbon pool
  - `soil_c_pool_lmwc` 
  - kg C $\textrm{m}^{-3}$
  - XY
* - Soil mineral associated organic matter carbon pool
  - `soil_c_pool_maom` 
  - kg C $\textrm{m}^{-3}$
  - XY
* - Soil microbial carbon pool
  - `soil_c_pool_microbe` 
  - kg C $\textrm{m}^{-3}$
  - XY
* - Soil particulate organic matter carbon pool
  - `soil_c_pool_pom` 
  - kg C $\textrm{m}^{-3}$
  - XY
* - Soil particulate organic matter enzyme pool
  - `soil_enzyme_pom` 
  - kg C $\textrm{m}^{-3}$
  - XY
* - Soil mineral associated organic matter enzyme pool
  - `soil_enzyme_maom` 
  - kg C $\textrm{m}^{-3}$
  - XY
```

This code creates a set of plausible values for which the
{mod}`~virtual_rainforest.models.soil.soil_model` absolutely has to function sensibly
for.Descriptions of the soil pools can be found [here](./soil/soil_details.md).

````{admonition} soil_example_data.py
:class: dropdown
```{literalinclude} ../../../virtual_rainforest/example_data/generation_scripts/soil_example_data.py
```
````

### Litter data

The `example_litter_data.nc` file provides:

```{list-table}
* - Variable
  - Name
  - Unit
  - Dims
* - above ground metabolic litter pools
  - `litter_pool_above_metabolic`
  - kg C $\textrm{m}^{-2}$ 
  - XY
* - above ground structural litter pools
  - `litter_pool_above_structural`
  - kg C $\textrm{m}^{-2}$ 
  - XY
* - woody litter pools
  - `litter_pool_woody`
  - kg C $\textrm{m}^{-2}$ 
  - XY
* - below ground metabolic litter pools
  - `litter_pool_below_metabolic`
  - kg C $\textrm{m}^{-2}$ 
  - XY
* - below ground structural litter pools
  - `litter_pool_below_structural`
  - kg C $\textrm{m}^{-2}$ 
  - XY
* - lignin proportion of above ground structural litter
  - `lignin_above_structural`
  - unitless
  - XY
* - lignin proportion of woody litter
  - `lignin_woody`
  - unitless
  - XY
* - lignin proportion of below ground structural litter
  - `lignin_below_structural`
  - unitless
  - XY
```

The generation script creates a set of plausible values for which the {mod}`~virtual_rainforest.models.litter.litter_model`
absolutely has to function sensibly for.
Descriptions of the litter pools can be found [here](./soil/soil_details.md).

````{admonition} litter_example_data.py
:class: dropdown
```{literalinclude} ../../../virtual_rainforest/example_data/generation_scripts/litter_example_data.py
```
````

### Plant data

The `example_plant_data.nc` file provides the following variables. Note that the plant
data introduces a new axis dimension for the cohorts of plant functional groups (C). In
this example data, a single cohort of each of the two configured functional groups is
added for each of the 81 grid cells, giving 162 entries along the cohort axis.

```{list-table}
* - Variable
  - Name
  - Unit
  - Dims
* - Cohort plant functional type
  - `plant_cohorts_pft`
  - string
  - C
* - Cohort diameter at breast height
  - `plant_cohorts_dbh`
  - m
  - C
* - Photosynthetic photon flux density
  - `photosynthetic_photon_flux_density`
  - µ mol m$^{-2}$ s$^{-1}$
  - XYT
```

````{admonition} plant_example_data.py
:class: dropdown
```{literalinclude} ../../../virtual_rainforest/example_data/generation_scripts/plant_example_data.py
```
````
